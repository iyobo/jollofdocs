<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.26" />
    <meta name="description" content="">


    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/images/favicon.png" type="image/x-icon" />

    <title>Models :: JollofJS Docs</title>
    
    
    <link href="/css/nucleus.css?1507527347" rel="stylesheet">
    <link href="/css/font-awesome.min.css?1507527347" rel="stylesheet">
    <link href="/css/hybrid.css?1507527347" rel="stylesheet">
    <link href="/css/featherlight.min.css?1507527347" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1507527347" rel="stylesheet">
    <link href="/css/horsey.css?1507527347" rel="stylesheet">
    <link href="/css/theme.css?1507527347" rel="stylesheet">
    <link href="/css/hugo-theme.css?1507527347" rel="stylesheet">
    

    <script src="/js/jquery-2.x.min.js?1507527347"></script>
    
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{ 
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/data/models/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">
    <h1>JollofJS</h1>
    
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1507527347"></script>
<script type="text/javascript" src="/js/horsey.js?1507527347"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/docs.jollofjs.com\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1507527347"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/basics/" title="Basics" class="dd-item 
        
        
        
        ">
      <a href="/basics/">
          <b>1. </b>Basics
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/basics/introduction/" title="Introduction" class="dd-item ">
        <a href="/basics/introduction/">
        Introduction
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/basics/requirements/" title="Requirements" class="dd-item ">
        <a href="/basics/requirements/">
        Requirements
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/basics/getting-started/" title="Getting Started" class="dd-item ">
        <a href="/basics/getting-started/">
        Getting Started
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/data/" title="Data" class="dd-item 
        parent
        
        
        ">
      <a href="/data/">
          <b>2. </b>Data
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/data/models/" title="Models" class="dd-item active">
        <a href="/data/models/">
        Models
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/data/fields/" title="Fields" class="dd-item ">
        <a href="/data/fields/">
        Fields
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/data/queries/" title="Queries" class="dd-item ">
        <a href="/data/queries/">
        Queries
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/controllers/" title="Controllers" class="dd-item 
        
        
        
        ">
      <a href="/controllers/">
          <b>3. </b>Controllers
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/controllers/flow/" title="Flow" class="dd-item ">
        <a href="/controllers/flow/">
        Flow
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/controllers/routes/" title="Routes" class="dd-item ">
        <a href="/controllers/routes/">
        Routes
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/views/" title="Views" class="dd-item 
        
        
        
        ">
      <a href="/views/">
          <b>4. </b>Views
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/views/nunjucks/" title="Nunjucks" class="dd-item ">
        <a href="/views/nunjucks/">
        Nunjucks
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/configuration/" title="Configuration" class="dd-item 
        
        
        
        ">
      <a href="/configuration/">
          <b>5. </b>Configuration
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/configuration/settings/" title="Settings" class="dd-item ">
        <a href="/configuration/settings/">
        Settings
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/configuration/deploying/" title="Deploying" class="dd-item ">
        <a href="/configuration/deploying/">
        Deploying
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/configuration/environments/" title="Environments" class="dd-item ">
        <a href="/configuration/environments/">
        Environments
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/admin/" title="Admin Interface" class="dd-item 
        
        
        
        ">
      <a href="/admin/">
          <b>6. </b>Admin Interface
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fa fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable sticky-parent">
              
              <div class="sticky-spacer">
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Home</a> > <a href='/data/'>Data</a> > Models
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#static-methods">Static Methods</a></li>
<li><a href="#instance-methods">Instance methods</a></li>
<li><a href="#native-methods">Native methods</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Models</h1>
          

        



<p>Models are how you tell JollofJS how to structure your data.</p>

<p>All models for your app MUST be placed under apps/models</p>

<p>Let&rsquo;s look at the User model in there</p>

<pre><code>const jollof = require('jollof');
const data = jollof.data;
const types = data.types;
const jql = data.jql;


const schema = {
    name: 'User',
    dataSource: 'default',
    structure: {
        firstName: String,
        lastName: String,
        name: { type: String, meta: { disableEdit: true } },
        email: types.Email(),
        password: { type: String, meta: { widget: 'password' } },
        isAdmin: Boolean,
        accountType: {
            type: String, meta: {
                choices: [
                    'normal',
                    'grand',
                    'epic'
                ]
            }
        }

    },

    ...

}


module.exports = data.registerModel(schema);
</code></pre>

<p>If you have worked with ODMs like Mongoose, this should look familiar.</p>

<h2 id="static-methods">Static Methods</h2>

<p>To extend this model statically, define schema.statics. ex:</p>

<pre><code>schema.statics = {
    async countAllUsersWithFirstName(firstName){

        //you have access to all models here via
        //jollof.models.AnyModel
        return await jollof.models.User.countBy({firstName});

    }
}
</code></pre>

<p>then you can call those from anywhere using <code>await jollof.models.User.countAllUsers()</code>.</p>

<h2 id="instance-methods">Instance methods</h2>

<p>To extend a model instance, define schema.methods. ex:</p>

<pre><code>schema.methods = {
    async printFullName(){

        //Again, you have access to all models here too via
        //jollof.models.AnyModel

        return this.firstName + ' '+this.lastName;
    }
}
</code></pre>

<p>Notice how <code>this</code> gives you access to the actual instance of the model instance you are extending.</p>

<p>You can call a model instance method from a model. i.e</p>

<pre><code>const user = jollof.models.User.findOneBy({email: 'foo@bar.com'})
...
//assuming user is not null

const fullName = user.printFullName()

console.log(fullName)

</code></pre>

<h2 id="native-methods">Native methods</h2>

<p>It is not Jollof Data&rsquo;s goal to claim to be everything you need to access your data layer.
No data abstraction layer can promise that. What it DOES do beautifully well, is get out of the way so you can do access your data yourself.
It does so by extending the data adapter for your model through Native methods.</p>

<p>Native methods are where Jollof Data supercedes all current known data abstraction paradigms.</p>

<pre><code>schema.native = {
    mongodb: {
        async init() {

            await this.db.collection('User').createIndex({ email: 1 }, { unique: true });
        },
    }
}

</code></pre>

<p>In fact, JollofJS actively encourages you to define native functions right from the start because the init() native function is the only place you can define indexes on your model.</p>

<p>When booting, Jollof Data will run the init function for any active native groups.
Here, I&rsquo;ll explain:</p>

<pre><code>In the startup project,
Because the User model uses the 'default' dataSource,
which is grouped under the nativeType named 'mongodb' (as seen in config/base.js under datasources),
Then that means the nativeType named 'mongodb' is the active nativeType.
This means that when the app is started, mongodb.init() will be run automatically by Jollof.

</code></pre>

<p>You can define and run other native functions besides init() (eg: generateGraph) and call it via jollof.models.User.native.generateGraph().
Notice how you do not specify the nativeType when calling a native function. JollofJS will figure that out for you depending on what is active.</p>


<footer class=" footline" >
	
</footer>


        
        </div> 
      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/data/" title="Data"> <i class="fa fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/data/fields/" title="Fields" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1507527347"></script>
    <script src="/js/perfect-scrollbar.min.js?1507527347"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1507527347"></script>
    <script src="/js/jquery.sticky-kit.min.js?1507527347"></script>
    <script src="/js/featherlight.min.js?1507527347"></script>
    <script src="/js/html5shiv-printshiv.min.js?1507527347"></script>
    <script src="/js/highlight.pack.js?1507527347"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom.71422.js?1507527347"></script>
    <script src="/js/learn.js?1507527347"></script>
    <script src="/js/hugo-learn.js?1507527347"></script>

    <link href="/mermaid/mermaid.css?1507527347" type="text/css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1507527347"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

